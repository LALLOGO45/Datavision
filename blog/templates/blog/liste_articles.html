{% extends 'core/base.html' %}

{% block title %}Nos Articles{% endblock %}

{% block extra_css %}
<style>
  .search-container {
    background: linear-gradient(135deg, #4f46e5 0%, #3730a3 100%);
    clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
  }

  .search-input {
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
  }

  .search-input:focus {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
  }

  .service-card {
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    background: #ffffff;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .service-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    border-color: #4f46e5;
  }

  .service-image-container {
    position: relative;
    overflow: hidden;
  }

  .service-image {
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .service-card:hover .service-image {
    transform: scale(1.1);
  }

  .service-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(79, 70, 229, 0.1) 0%, transparent 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .service-card:hover .service-overlay {
    opacity: 1;
  }

  .pagination-link {
    transition: all 0.3s ease;
    color: #4f46e5;
    background: #ffffff;
    border: 1px solid rgba(79, 70, 229, 0.2);
  }

  .pagination-link:hover {
    transform: translateY(-2px);
    background: #4f46e5;
    color: #ffffff;
    border-color: #4f46e5;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .service-card:nth-child(1) { animation-delay: 0.1s; }
  .service-card:nth-child(2) { animation-delay: 0.2s; }
  .service-card:nth-child(3) { animation-delay: 0.3s; }
  .service-card:nth-child(4) { animation-delay: 0.4s; }
  .service-card:nth-child(5) { animation-delay: 0.5s; }
  .service-card:nth-child(6) { animation-delay: 0.6s; }

  .empty-state {
    animation: fadeIn 1s ease;
    background: #ffffff;
    border: 2px dashed rgba(79, 70, 229, 0.2);
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-purple-50 via-indigo-50 to-blue-50">
    <!-- Section Héro avec Recherche -->
    <div class="relative bg-gradient-to-r from-purple-700 via-indigo-700 to-blue-700 py-20 px-4 mb-16" style="clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);">
      <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1557683316-973673baf926?auto=format&fit=crop&q=80')] opacity-10" style="mix-blend-mode: overlay;"></div>
      <div class="container mx-auto max-w-4xl relative">
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-32 h-1 bg-gradient-to-r from-transparent via-white to-transparent"></div>
        <h1 class="text-5xl md:text-6xl font-bold text-white text-center mb-8" style="text-shadow: 0 2px 4px rgba(0,0,0,0.1);">
          Découvrez Nos Articles
        </h1>
        <div class="relative max-w-2xl mx-auto">
          <form method="GET" class="flex gap-4">
            <input 
              type="text" 
              name="search"
              value="{{ request.GET.search|default:'' }}"
              class="w-full px-6 py-4 rounded-xl text-white placeholder-gray-300 border border-white/20 
                     focus:outline-none focus:border-white/40 transition-all duration-300
                     bg-white/10 backdrop-blur-md focus:bg-white/20 transform hover:translate-y-[-2px]
                     shadow-inner shadow-white/10"
              placeholder="Rechercher un service..." 
            >
            <button 
              type="submit"
              class="px-8 py-4 bg-white text-indigo-700 rounded-xl font-semibold 
                     transition-all duration-300 shadow-lg hover:shadow-xl
                     hover:bg-indigo-50 hover:scale-105 active:scale-95"
            >
              <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
              Rechercher
            </button>
          </form>
        </div>
      </div>
    </div>

  <!-- Services Grid -->
  <div class="container mx-auto px-4 mb-16">
    <div class="grid gap-8 grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
      {% for article in page_obj %}
        <div class="service-card rounded-2xl overflow-hidden">
          <div class="service-image-container aspect-video">
            <img 
              src="{{ article.image.url }}" 
              alt="{{ article.titre }}" 
              class="service-image w-full h-full object-cover"
            >
            <div class="service-overlay"></div>
          </div>
          <div class="p-6">
            <h3 class="text-xl font-bold text-gray-900 mb-3">{{ article.titre }}</h3>
            <p class="text-gray-600 mb-4">{{ article.contenu|truncatewords:20 }}</p>
            <a 
              href="{% url 'detail_article' article.id %}" 
              class="inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-300"
            >
              En savoir plus
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </a>
          </div>
        </div>
      {% empty %}
        <div class="col-span-full empty-state py-16 text-center">
          <div class="bg-white rounded-2xl p-8 max-w-md mx-auto">
            <svg class="w-16 h-16 text-indigo-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
            </svg>
            <h3 class="text-xl font-semibold text-gray-900 mb-2">Aucun <article></article> disponible</h3>
            <p class="text-gray-600">Revenez bientôt pour découvrir nos nouveaux articles!</p>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if page_obj.paginator.num_pages > 1 %}
    <div class="mt-12 flex justify-center">
      <nav class="inline-flex rounded-lg shadow-sm" aria-label="Pagination">
        {% if page_obj.has_previous %}
          <a 
            href="?page=1{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" 
            class="pagination-link relative inline-flex items-center px-4 py-2 rounded-l-lg"
          >
            <span class="sr-only">Première page</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"/>
            </svg>
          </a>
          <a 
            href="?page={{ page_obj.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" 
            class="pagination-link relative inline-flex items-center px-4 py-2"
          >
            <span class="sr-only">Page précédente</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
          </a>
        {% endif %}

        <span class="relative inline-flex items-center px-4 py-2 bg-indigo-50 text-indigo-600 font-medium">
          Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
          <a 
            href="?page={{ page_obj.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" 
            class="pagination-link relative inline-flex items-center px-4 py-2"
          >
            <span class="sr-only">Page suivante</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </a>
          <a 
            href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" 
            class="pagination-link relative inline-flex items-center px-4 py-2 rounded-r-lg"
          >
            <span class="sr-only">Dernière page</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"/>
            </svg>
          </a>
        {% endif %}
      </nav>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Intersection Observer for animation timing
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.animationPlayState = 'running';
      }
    });
  }, {
    threshold: 0.1,
    rootMargin: '50px'
  });

  // Observe all service cards
  document.querySelectorAll('.service-card').forEach(card => {
    card.style.animationPlayState = 'paused';
    observer.observe(card);
  });

  // Smooth scroll behavior for pagination links
  document.querySelectorAll('.pagination-link').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const href = link.getAttribute('href');
      window.location.href = href;
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
  });
</script>
{% endblock %}